[2019-10-04 20:17:07,469] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: capstone_project_dag.create_staging_database_tables 2019-10-05T01:16:11.794605+00:00 [queued]>
[2019-10-04 20:17:07,479] {taskinstance.py:620} INFO - Dependencies all met for <TaskInstance: capstone_project_dag.create_staging_database_tables 2019-10-05T01:16:11.794605+00:00 [queued]>
[2019-10-04 20:17:07,479] {taskinstance.py:838} INFO - 
--------------------------------------------------------------------------------
[2019-10-04 20:17:07,479] {taskinstance.py:839} INFO - Starting attempt 1 of 4
[2019-10-04 20:17:07,479] {taskinstance.py:840} INFO - 
--------------------------------------------------------------------------------
[2019-10-04 20:17:07,501] {taskinstance.py:859} INFO - Executing <Task(PostgresOperator): create_staging_database_tables> on 2019-10-05T01:16:11.794605+00:00
[2019-10-04 20:17:07,502] {base_task_runner.py:133} INFO - Running: ['airflow', 'run', 'capstone_project_dag', 'create_staging_database_tables', '2019-10-05T01:16:11.794605+00:00', '--job_id', '1027', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/project_dag.py', '--cfg_path', '/var/folders/dr/9yvjlnm11xv25k2gknf2n3z00000gn/T/tmp1r503gvb']
[2019-10-04 20:17:08,092] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables /usr/local/lib/python3.7/site-packages/airflow/configuration.py:627: DeprecationWarning: You have two airflow.cfg files: /Users/victorialemay/airflow/airflow.cfg and /Users/victorialemay/Courses/Udacity/Data Engineering Nanodegree/capstone/project-archive/airflow/airflow.cfg. Airflow used to look at ~/airflow/airflow.cfg, even when AIRFLOW_HOME was set to a different value. Airflow will now only read /Users/victorialemay/Courses/Udacity/Data Engineering Nanodegree/capstone/project-archive/airflow/airflow.cfg, and you should remove the other file
[2019-10-04 20:17:08,093] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables   category=DeprecationWarning,
[2019-10-04 20:17:08,237] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables [2019-10-04 20:17:08,236] {settings.py:213} INFO - settings.configure_orm(): Using pool settings. pool_size=5, max_overflow=10, pool_recycle=1800, pid=7298
[2019-10-04 20:17:08,449] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables [2019-10-04 20:17:08,448] {__init__.py:51} INFO - Using executor LocalExecutor
[2019-10-04 20:17:08,858] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables [2019-10-04 20:17:08,857] {dagbag.py:90} INFO - Filling up the DagBag from /Users/victorialemay/Courses/Udacity/Data Engineering Nanodegree/capstone/project-archive/airflow/dags/project_dag.py
[2019-10-04 20:17:08,908] {base_task_runner.py:115} INFO - Job 1027: Subtask create_staging_database_tables [2019-10-04 20:17:08,907] {cli.py:516} INFO - Running <TaskInstance: capstone_project_dag.create_staging_database_tables 2019-10-05T01:16:11.794605+00:00 [running]> on host 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa
[2019-10-04 20:17:08,953] {postgres_operator.py:62} INFO - Executing: CREATE TABLE IF NOT EXISTS public.i94_immigration_staging (
    cicid float,
    i94yr float,
    i94mon float,
    i94cit float,
    i94res float,
    i94port varchar,
    arrdate float,
    i94mode float,
    i94addr varchar,
    depdate float,
    i94bir float,
    i94visa float,
    "count" float,
    dtadfile varchar,
    visapost varchar,
    occup varchar,
    entdepa varchar,
    entdepd varchar,
    entdepu varchar,
    matflag varchar,
    biryear float,
    dtaddto varchar,
    gender varchar,
    insnum varchar,
    airline varchar,
    admnum float,
    fltno varchar,
    visa_type varchar
);

CREATE TABLE IF NOT EXISTS public.land_temp_staging (
    dt varchar,
    AverageTemperature numeric(20,16),
    AverageTemperatureUncertainty numeric(20,16),
    City varchar,
    Country varchar,
    Latitude varchar,
    Longitude varchar
);

CREATE TABLE IF NOT EXISTS public.demographic_staging (
    City varchar,
    State varchar,
    MedianAge numeric(5,2),
    MalePopulation int4,
    FemalePopulation int4,
    TotalPopulation int4,
    NumberOfVeterans int4,
    ForeignBorn int4,
    AverageHouseholdSize numeric(3,1),
    StateCode varchar,
    Race varchar,
    Count int4
);

CREATE TABLE IF NOT EXISTS public.port_code_staging (
    name varchar,
    state_code varchar,
    country_name varchar,
    i94_port_code varchar
);
[2019-10-04 20:17:08,966] {logging_mixin.py:95} INFO - [[34m2019-10-04 20:17:08,966[0m] {[34mbase_hook.py:[0m84} INFO[0m - Using connection to: [1mid: redshift. Host: redshift-cluster-1.c4i0rfzboubh.us-west-2.redshift.amazonaws.com, Port: 5439, Schema: dev, Login: awsuser, Password: XXXXXXXX, extra: {}[0m[0m
[2019-10-04 20:17:09,563] {logging_mixin.py:95} INFO - [[34m2019-10-04 20:17:09,563[0m] {[34mdbapi_hook.py:[0m171} INFO[0m - CREATE TABLE IF NOT EXISTS public.i94_immigration_staging (
    cicid float,
    i94yr float,
    i94mon float,
    i94cit float,
    i94res float,
    i94port varchar,
    arrdate float,
    i94mode float,
    i94addr varchar,
    depdate float,
    i94bir float,
    i94visa float,
    "count" float,
    dtadfile varchar,
    visapost varchar,
    occup varchar,
    entdepa varchar,
    entdepd varchar,
    entdepu varchar,
    matflag varchar,
    biryear float,
    dtaddto varchar,
    gender varchar,
    insnum varchar,
    airline varchar,
    admnum float,
    fltno varchar,
    visa_type varchar
);

CREATE TABLE IF NOT EXISTS public.land_temp_staging (
    dt varchar,
    AverageTemperature numeric(20,16),
    AverageTemperatureUncertainty numeric(20,16),
    City varchar,
    Country varchar,
    Latitude varchar,
    Longitude varchar
);

CREATE TABLE IF NOT EXISTS public.demographic_staging (
    City varchar,
    State varchar,
    MedianAge numeric(5,2),
    MalePopulation int4,
    FemalePopulation int4,
    TotalPopulation int4,
    NumberOfVeterans int4,
    ForeignBorn int4,
    AverageHouseholdSize numeric(3,1),
    StateCode varchar,
    Race varchar,
    Count int4
);

CREATE TABLE IF NOT EXISTS public.port_code_staging (
    name varchar,
    state_code varchar,
    country_name varchar,
    i94_port_code varchar
);[0m
[2019-10-04 20:17:09,971] {postgres_operator.py:67} INFO - INFO:  Relation "i94_immigration_staging" already exists and will be skipped

[2019-10-04 20:17:09,971] {postgres_operator.py:67} INFO - INFO:  Relation "land_temp_staging" already exists and will be skipped

[2019-10-04 20:17:09,972] {postgres_operator.py:67} INFO - INFO:  Relation "demographic_staging" already exists and will be skipped

[2019-10-04 20:17:09,972] {postgres_operator.py:67} INFO - INFO:  Relation "port_code_staging" already exists and will be skipped

[2019-10-04 20:17:12,464] {logging_mixin.py:95} INFO - [[34m2019-10-04 20:17:12,463[0m] {[34mlocal_task_job.py:[0m105} INFO[0m - Task exited with return code 0[0m
